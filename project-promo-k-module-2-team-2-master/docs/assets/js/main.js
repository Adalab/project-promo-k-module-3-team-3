"use strict";const linkData={};function setData(){let e=document.querySelector(".js__profile-image").style.backgroundImage;e=e.slice(5,e.length,1),linkData.photo=e}const palette=document.querySelector(".js-palette"),colorPalette=[0,1,2,3];function paletteChange(){function e(e){for(let t in colorPalette){const o=colorPalette[t];palette.classList.remove("palette"+o);const r=document.querySelector(".js-color"+o);e.currentTarget.classList.contains("js-col"+o)&&(r.checked=!0,palette.classList.add("palette"+o),localStorage.setItem("palette",JSON.stringify(t)),linkData.palette=o+1)}}for(let t of colorPalette){document.querySelector(".js-col"+t).addEventListener("click",e)}}function startPalette(){if(palette.classList.contains("palettenull")){palette.classList.add("palette0"),palette.classList.remove("palettenull");document.querySelector(".js-color0").checked=!0}}function startPhoto(){const e=document.querySelector(".js__profile-image");null===localStorage.getItem("palette")&&(e.style.backgroundImage="none")}const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,fileField.removeAttribute("type","file"),fileField.setAttribute("type","file"),linkData.photo=`url(${fr.result})`,localStorage.setItem("photo",`url(${fr.result})`),fillImage(),console.log(linkData)}function fillImage(){profilePreview.style.backgroundImage=profileImage.style.backgroundImage}function fakeFileClick(){fileField.click()}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const formData={name:{placeholder:"Catrina de Guadalupe",property:"innerHTML",prefix:"",remove:!1},job:{placeholder:"Calavera Garbancera",property:"innerHTML",prefix:"",remove:!1},phone:{placeholder:"",property:"href",prefix:"tel:",remove:!1},email:{placeholder:"",property:"href",prefix:"mailto:",remove:!1},linkedin:{placeholder:"",property:"href",prefix:"https://linkedin.es/in/",remove:!0},github:{placeholder:"",property:"href",prefix:"https://github.com/",remove:!0}};function fillCard(){for(let e in formData){const t=document.querySelector(".js-intro-"+e),o=t.id;let r=t.value;const a=document.querySelector(".js-preview-"+o),l=formData[o].property,n=formData[o].placeholder,c=formData[o].prefix,i=formData[o].remove;""===r?(a[l]=n,a.removeAttribute("href")):(!0===i&&(r=r.replace(c,""),r=r.replace("@",""),r=r.replace("/","")),a[l]=c+r)}}function setDataInLocalStorage(){for(let e in formData){let t=document.querySelector(".js-intro-"+e).value;localStorage.setItem(e,JSON.stringify(t)),linkData[""+e]=t}}function getDataFromLocalStorage(){for(let e in formData){const t=JSON.parse(localStorage.getItem(e));document.querySelector(".js-intro-"+e).value=t}const e=JSON.parse(localStorage.getItem("palette"));document.querySelector(".js-palette").classList.add("palette"+e),linkData.palette=parseInt(e)+1;for(const t in colorPalette){const o=document.querySelector(".js-color"+t);o.classList.contains("js-color"+e)&&(o.checked=!0)}const t=localStorage.getItem("photo");document.querySelector(".js__profile-image").style.backgroundImage=t}function updateCard(){startPalette(),fillCard(),paletteChange(),fillImage(),setDataInLocalStorage(),setData()}for(let e in formData){document.querySelector(".js-intro-"+e).addEventListener("keyup",updateCard)}getDataFromLocalStorage(),updateCard();const buttonArrowDesign=document.querySelector(".js-form__box__button--design"),buttonArrowFill=document.querySelector(".js-form__box__button--fill"),buttonArrowShare=document.querySelector(".js-form__box__button--share"),formBoxDesign=document.querySelector(".form__color--container"),formBoxFill=document.querySelector(".form__data"),formBoxShare=document.querySelector(".form__share--container");function handleButtonArrowClick(e){e.currentTarget.classList.toggle("btn-rotate"),!0===buttonArrowDesign.classList.contains("btn-rotate")?(formBoxDesign.style.height="200px",formBoxDesign.style.opacity="1"):!1===buttonArrowDesign.classList.contains("btn-rotate")&&(formBoxDesign.style.height="0",formBoxDesign.style.opacity="0"),!0===buttonArrowFill.classList.contains("btn-rotate")?(formBoxFill.style.height="556px",formBoxFill.style.opacity="1"):!1===buttonArrowFill.classList.contains("btn-rotate")&&(formBoxFill.style.height="0",formBoxFill.style.opacity="0"),!0===buttonArrowShare.classList.contains("btn-rotate")?(formBoxShare.style.height="110px",formBoxShare.style.opacity="1"):!1===buttonArrowShare.classList.contains("btn-rotate")&&(formBoxShare.style.height="0",formBoxShare.style.opacity="0",buttonSubmit.classList.remove("change-color")),e.preventDefault()}buttonArrowDesign.addEventListener("click",handleButtonArrowClick),buttonArrowFill.addEventListener("click",handleButtonArrowClick),buttonArrowShare.addEventListener("click",handleButtonArrowClick);const buttonSubmit=document.querySelector(".js-form__share--button");function handleButtonSubmit(e){if(buttonSubmit.classList.add("change-color"),buttonSubmit.classList.contains("change-color")){formBoxShare.style.height="250px";document.querySelector(".form__share--message").classList.add("js-show-form__share--message")}sendRequest(),showURL(!0),e.preventDefault()}buttonSubmit.addEventListener("click",handleButtonSubmit);const reset=document.querySelector(".js-reset"),paletteReset=document.querySelector(".js-palette");function resetCard(){for(let e in formData){document.querySelector(".js-intro-"+e).value=""}profileImage.style.backgroundImage="";for(let e in colorPalette)palette.classList.remove("palette"+e);palette.classList.add("palette0");document.querySelector(".js-color0").checked=!0,buttonSubmit.classList.contains("change-color")&&(formBoxShare.style.height="110px"),buttonSubmit.classList.remove("change-color"),updateCard(),paletteChange(),localStorage.clear()}function sendRequest(e){fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(linkData),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){showURL(e)}))}function showURL(e){const t=document.querySelector(".js-card-link"),o=document.querySelector(".js-twitter"),r=encodeURIComponent("Â¡He creado mi tarjeta con Catrina's profile cards!"),a=document.querySelector(".js-created");!0===e.success?(t.innerHTML=e.cardURL,t.href=e.cardURL,o.style.display="unset",a.innerHTML="Tu tarjeta ha sido creada",o.href=`https://twitter.com/intent/tweet?text=${r}&url=${e.cardURL}&hashtags=Catrinas,Team2,PromoKizzy,Adalab&via=yanira_fr,@Chopper_hat,@teresaurio_,@Sus_G1`,o.innerHTML='<i class="fab fa-twitter"></i> Compartir en twitter</a>'):void 0===e.error?(t.innerHTML='Creando tu link</br><i class="fas fa-spinner"></i>',o.style.display="none",a.innerHTML=" ",t.removeAttribute("href")):(t.innerHTML="ERROR: "+e.error,t.removeAttribute("href"),o.style.display="none",a.innerHTML=" ")}reset.addEventListener("click",resetCard);